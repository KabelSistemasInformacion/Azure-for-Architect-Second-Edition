/*
 * This function is not intended to be invoked directly. Instead it will be
 * triggered by an HTTP starter function.
 * 
 * Before running this sample, please:
 * - create a Durable activity function (default name is "Hello")
 * - create a Durable HTTP starter function
 */

#r "Microsoft.Azure.WebJobs.Extensions.DurableTask"

public static async Task<List<string>> Run(DurableOrchestrationContext context)
{
    using (var cts = new CancellationTokenSource()) {
        var timeout = ctx.CurrentUtcDateTime.AddMinutes(100);
        var activityTimeOut = ctx.CreateTimer(timeout, cts.Token);
        var isEmailSendTask = ctx.WaitForExternalEvent<string>("EMailApproval");
        var activityProcessed = await Task.WhenAny(isEmailSendTask,  activityTimeOut);
        
        if (activityProcessed == isEmailSendTask) {
            activityFlow = isEmailSendTask.Result;
            cts.Cancel();
        }
    }
}

public class employee
{
    public string firstName { get; set; }
    public string lastName { get; set; }
    public string Email { get; set; }
    public string PhoneNumber { get; set; }
}